@model SmallEnergy.Models.UsersViewModel;
@{
	ViewData["Title"] = "All Users";
}


<div class="card">
	<div class="card-header">
		Show all users
	</div>
	<div class="card-content">
		<div class="card-content-table-actions">
			<div class="card-content-table-actions-group">
				<form asp-controller="User" asp-action="ShowAllUsers">
					<input type="text" class="input" name="filter" list="predefinedSearches" placeholder="search for username..." />

					<datalist id="predefinedSearches">
						@foreach (string option in Model.Searches)
						{
							<option value="@option"></option>
						}
					</datalist>

					<button class="button primary">Search</button>
				</form>
			</div>
			<div class="card-content-table-actions-group">
				<a class="button success" asp-controller="User" asp-action="CreateUser">Create new user</a>
			</div>
			<div class="card-content-table-actions-group">
				<button class="button primary">Testing</button>
			</div>
		</div>
		@if (Model.Users.Count() > 0)
		{
			<table>
				<tr>
					<th>Id</th>
					<th>User Disabled</th>
					<th>User Name</th>
					<th>User Login</th>
					<th>Last Password Change</th>
					<th>Last Login Date</th>
					<th>Create Date</th>
					<th>Kind</th>
					<th colspan="3">Actions</th>
				</tr>
				@foreach (var user in Model.Users)
				{
					<tr>
						<td>@user.Id</td>
						<td>@user.userDisabled</td>
						<td>@user.userName</td>
						<td>@user.userLogin</td>
						<td>@user.lastPasswordChangeDate</td>
						<td>@user.lastLoginDate</td>
						<td>@user.createDate</td>
						<td>@user.kind</td>

						<td>
							<a class="button success" asp-controller="User" asp-action="EditUser" asp-route-id="@user.Id">Edit</a>
						</td>
						<td>
							<a class="button primary" asp-controller="User" asp-action="Details" asp-route-id="@user.Id">Details</a>
						</td>
						<td>
							<form asp-controller="User" asp-action="DeleteMember" method="post">
								<input type="hidden" name="Id" value="@user.Id" />
								<button class="button danger">Delete</button>
							</form>
						</td>
					</tr>
				}
			</table>
		}
		else
		{
			@foreach (string search in Model.Searches)
			{
				<h1>Couldnt find anything. Most people search for "@search"</h1>
				break;
			}
		}
	</div>
</div>

@if (Model.Users.Count() > 0)
{
	<ul class="pagination">
		<li><a asp-action="ShowAllUsers" asp-controller="User" asp-route-id="1" asp-route-filter="@Model.filter">&laquo;</a></li>
		@for (int i = Model.Pagination.CurrentPage; i < Model.Pagination.CurrentPage + 5; i++)
		{
			int pageNum = i;
			if (Model.Pagination.CurrentPage > 1) { pageNum--; }
			if (pageNum > Model.Pagination.maxPages) { break; }
			<li><a asp-action="ShowAllUsers" asp-controller="User" asp-route-id="@pageNum" asp-route-filter="@Model.filter">@pageNum</a></li>
		}
		<li><a asp-action="ShowAllUsers" asp-controller="User" asp-route-id="@Model.Pagination.maxPages" asp-route-filter="@Model.filter">&raquo;</a></li>
	</ul>
}
